# 캘린더 프로젝트 테스트 전략 (수정판)

> **현재 131개 테스트로 견고한 테스트 스위트 보유.** E2E 테스트로 브라우저 호환성을 보강한다.

---

## 1. 테스트 피라미드 목표 비율

| 유형                 | 목표 비중 | 목적                                 |
| -------------------- | --------- | ------------------------------------ |
| Unit (훅·유틸리티)   | 40 %      | 비즈니스 규칙을 빠르게 검증          |
| Integration (플로우) | 40 %      | 폼 → 훅 → 상태 → UI 데이터 흐름 보장 |
| **E2E**              | **20 %**  | 실제 사용자 시나리오 보호            |
| Visual Regression    | ✖︎        | 이번 범위에서 제외                   |

---

## 2. E2E 테스트 설계

### 2-1 도구

- **Playwright** (멀티 브라우저·모바일·네트워크 시뮬레이션 지원)
- 기존 MSW 핸들러 재사용 → 외부 API 의존 제거

### 2-2 E2E 범위 선택 기준

#### **CRUD 테스트 제외**

- **테스트 독립성 파괴**: 일정 추가/수정/삭제로 인한 상태 변경이 다른 테스트에 영향
- **병렬 실행 불가**: 여러 브라우저가 동일한 JSON 파일 동시 수정시 Race Condition 발생
- **플래키 테스트 위험**: 이전 테스트 실패시 연쇄적 실패, 테스트 순서 의존성 발생
- **통합테스트로 충분**: 131개 테스트로 CRUD 로직은 이미 완벽히 검증됨

#### **비파괴적 테스트 선택**

- **상태 변경 없음**: 기존 데이터만 읽고 UI 동작만 확인
- **브라우저별 차이**: jsdom으로 검증 불가능한 실제 렌더링/동작 확인
- **사용자 경험**: 실제 브라우저 환경에서의 UI 인터랙션 검증

### 2-3 핵심 시나리오 3선 (통합테스트 한계 보완)

#### **E2E-01: 알림 표시**

- **테스트**: `clock.tick(60000)` → 알림 배지/토스트 표시 확인
- **통합 한계**: jsdom에서 실제 타이머 동작, 시각적 알림 표시 확인 불가
- **E2E 가치**: 브라우저별 타이머, 알림 UI 실제 렌더링 검증
- **독립성**: 기존 데이터만 읽음, 상태 변경 없음

#### **E2E-02: 모달 인터랙션**

- **테스트**: 충돌 모달 열기 → ESC로 닫기 → 배경 클릭으로 닫기
- **통합 한계**: 모달의 실제 z-index, 포커스 트랩, 스크롤 차단 확인 불가
- **E2E 가치**: 브라우저별 모달 렌더링 차이 검증
- **독립성**: 모달만 확인, 실제 저장은 취소

#### **E2E-03: 캘린더 뷰 렌더링**

- **테스트**: 주간/월간 뷰 전환 → 날짜 표시 확인
- **통합 한계**: 복잡한 테이블 레이아웃, CSS Grid 실제 렌더링 확인 불가
- **E2E 가치**: 브라우저별 캘린더 표시 차이 검증
- **독립성**: 기존 데이터만 읽음, 뷰 전환만 테스트

---

## 3. 기능별 현재 커버리지 & 잔여 과제

| 기능 영역        | 복잡도 | 현행 단위·통합 커버리지                | 통합테스트 한계               | 필요한 E2E 테스트 |
| ---------------- | ------ | -------------------------------------- | ----------------------------- | ----------------- |
| 실시간 알림      | High   | ✅ 훅 단위 완료 \| ✅ 통합 완료        | jsdom 타이머, 시각적 UI 표시  | **E2E-01**        |
| 이벤트 충돌 모달 | High   | ✅ 단위 (eventOverlap) \| ✅ 통합 완료 | 실제 모달 포커스/z-index      | **E2E-02**        |
| 캘린더 뷰 렌더링 | Medium | ✅ 통합 완료                           | 복잡한 테이블 레이아웃 렌더링 | **E2E-03**        |
| 반복 일정 CRUD   | High   | ✅ 단위 (repeatUtils) \| ✅ 통합 완료  | 없음 (충분히 검증됨)          | **제외**          |
| 검색 기능        | Medium | ✅ 단위 완료 \| ✅ 통합 완료           | 없음 (충분히 검증됨)          | **제외**          |

## 5. 작업 계획

1. **E2E 시나리오 3개 구현 (필수)**

   - E2E-01 알림 표시 (통합테스트 한계 1순위)
   - E2E-02 모달 인터랙션 (포커스/z-index 검증)
   - E2E-03 캘린더 뷰 렌더링 (테이블 레이아웃)

2. **후순위 개선(시간 여유 시)**
   - 모바일 브라우저 호환성 테스트
   - 대량 데이터 처리 성능 테스트
   - 네트워크 오류 시나리오 E2E 테스트
   - CI 테스트실패 시 스크린샷·비디오 아티팩트 업로드 → 머지 차단
